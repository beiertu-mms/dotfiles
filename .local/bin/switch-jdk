#!/usr/bin/env bash
#===============================================================================
#
#          FILE: switch-jdk
#
#         USAGE: ./switch-jdk
#
#   DESCRIPTION: Switch JDK and send signal 12 to dwmblocks.
#
#  REQUIREMENTS: archlinux-java, sed, awk, fzf, doas
#        AUTHOR: tung beier
#       CREATED: 11 March 2021 20:57 CET
#===============================================================================

set -o errexit  # Exit when a command fails
                # Use || true if a command is allowed to fail
set -o nounset  # Treat unset variables as an error
set -o pipefail # Exit when a command in a pipeline fails

SELECTED=$(archlinux-java status | sed '1d' | awk '{$1=$1};1' | fzf)
if [[ -z "$SELECTED" || "$SELECTED" =~ default ]]; then
    exit 0
fi

doas archlinux-java set "$SELECTED"
pkill -RTMIN+12 dwmblocks

