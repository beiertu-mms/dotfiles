#!/usr/bin/env bash

# Install/update ktlint
# See also https://github.com/pinterest/ktlint#installation

set -o errexit  # Exit when a command fails
                # Use || true if a command is allowed to fail
set -o nounset  # Treat unset variables as an error
set -o pipefail # Exit when a command in a pipeline fails

function run() {
  read -rp 'ktlint version: ' version
  [ -z "$version" ] && echo 'invalid version' && exit 1

  local dl_dir="$HOME/downloads"

  curl "https://github.com/pinterest/ktlint/releases/download/${version}/ktlint" \
    --show-error --location --remote-name --output-dir "$dl_dir"
  chmod a+x "${dl_dir}/ktlint"
  mv -u "${dl_dir}/ktlint" ~/.local/bin/ktlint
}

run "$@"
